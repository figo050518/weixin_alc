<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.fcgo.weixin.persist.dao.IOrderInfoDAO" >
	  <resultMap id="PageOrderInfotMap" type="com.fcgo.weixin.persist.po.OrderInfoPO" >
			<id column="ID" property="id" jdbcType="INTEGER" />
		    <result column="IS_DELETE" property="isDelete" jdbcType="INTEGER" />
		    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
		    <result column="UPDATE_TIME" property="updateTime" jdbcType="TIMESTAMP" />
		    <result column="ORDER_NUM" property="orderNum" jdbcType="VARCHAR" />
		    <result column="ORDER_STATE" property="orderState" jdbcType="INTEGER" />
		    <result column="PAY_WAY" property="payWay" jdbcType="VARCHAR" />
		    <result column="PAY_TIME" property="payTime" jdbcType="TIMESTAMP" />
		    <result column="SEND_TIME" property="sendTime" jdbcType="TIMESTAMP" />
		    <result column="USER_ID" property="userId" jdbcType="INTEGER" />
		    <result column="SELLER_ID" property="sellerId" jdbcType="INTEGER" />
		    <result column="SHOP_ID" property="shopId" jdbcType="INTEGER" />
		    <result column="ACT_PAY_AMOUNT" property="actPayAmount" jdbcType="DECIMAL" />
		    <result column="FREIGHT_AMOUNT" property="freightAmount" jdbcType="DECIMAL" />
		    <result column="PRO_AMOUNT" property="proAmount" jdbcType="DECIMAL" />
		    <result column="ORD_DISCOUNT" property="ordDiscount" jdbcType="DECIMAL" />
		    <result column="LOGISTICS_NUM" property="logisticsNum" jdbcType="VARCHAR" />
		    <result column="LOGISTICS_COMP" property="logisticsComp" jdbcType="VARCHAR" />
		    <result column="SELLER_REMARKS" property="sellerRemarks" jdbcType="VARCHAR" />
		    <result column="CLOSE_DESC" property="closeDesc" jdbcType="VARCHAR" />
		    <result column="IS_EALUATE" property="isEaluate" jdbcType="INTEGER" />
		    <result column="FINISH_TIME" property="finishTime" jdbcType="TIMESTAMP" />
		    <result column="CANCEL_TIME" property="cancelTime" jdbcType="TIMESTAMP" />
		    <result column="CREATE_NAME" property="createName" jdbcType="VARCHAR" />
		    <result column="UPDATE_NAME" property="updateName" jdbcType="VARCHAR" />
		    <result column="DEL_NAME" property="delName" jdbcType="VARCHAR" />
		    <result column="DEL_TIME" property="delTime" jdbcType="TIMESTAMP" />
		    <result column="order_type" property="orderType" jdbcType="INTEGER" />
		    <result column="CANCEL_TYPE" property="cancelType" jdbcType="INTEGER" />
	  </resultMap>
	  <!-- <sql id="orderInfo.columns" >
    	ID, IS_DELETE, CREATE_TIME, UPDATE_TIME, ORDER_NUM, ORDER_STATE, PAY_WAY, PAY_TIME, 
    	SEND_TIME, USER_ID, SELLER_ID, SHOP_ID, ACT_PAY_AMOUNT, FREIGHT_AMOUNT, PRO_AMOUNT, 
    	ORD_DISCOUNT, LOGISTICS_NUM, LOGISTICS_COMP, SELLER_REMARKS, CLOSE_DESC, IS_EALUATE, 
    	FINISH_TIME, CANCEL_TIME, CREATE_NAME, UPDATE_NAME, DEL_NAME, DEL_TIME, order_type, 
    	CANCEL_TYPE
  	  </sql> -->
	  <select id="orderInfoPage" parameterType="map" resultMap="PageOrderInfotMap">
  
  		select ID, IS_DELETE, CREATE_TIME, UPDATE_TIME as updateTime, ORDER_NUM, ORDER_STATE as orderState, PAY_WAY, PAY_TIME, 
    	SEND_TIME, USER_ID, SELLER_ID, SHOP_ID, ACT_PAY_AMOUNT, FREIGHT_AMOUNT, PRO_AMOUNT, 
    	ORD_DISCOUNT, LOGISTICS_NUM, LOGISTICS_COMP, SELLER_REMARKS, CLOSE_DESC, IS_EALUATE, 
    	FINISH_TIME, CANCEL_TIME, CREATE_NAME, UPDATE_NAME, DEL_NAME, DEL_TIME, order_type, 
    	CANCEL_TYPE from ord_order_info where 1=1 and IS_DELETE=0
  		<!-- 买家 -->
  		<if test="userType=='1'.toString()">
			AND USER_ID = #{userId,jdbcType=VARCHAR} 
		</if>
  		 <!-- 卖家 -->
  		<if test="userType=='2'.toString()">
			AND SELLER_ID = #{userId,jdbcType=VARCHAR} 
		</if>
		 <!-- 订单状态不为空时添加订单状态条件 -->
		 <if test="orderState!=null and orderState!=''">
			AND order_State = #{orderState,jdbcType=VARCHAR} 
		</if>
		<!-- 排序字段 ,方式（ase desc） -->
		<if test="sorter!=null and sorter!=''">
			 ORDER BY #{sorter}
		</if>
  		  limit #{startPage, jdbcType=DECIMAL},#{endPage, jdbcType=DECIMAL}
  </select>
  <select id="getOrderInfoListPage" parameterType="map" resultMap="PageOrderInfotMap">
  
  		select ID, IS_DELETE, CREATE_TIME, UPDATE_TIME as updateTime, ORDER_NUM, ORDER_STATE as orderState, PAY_WAY, PAY_TIME, 
    	SEND_TIME, USER_ID, SELLER_ID, SHOP_ID, ACT_PAY_AMOUNT, FREIGHT_AMOUNT, PRO_AMOUNT, 
    	ORD_DISCOUNT, LOGISTICS_NUM, LOGISTICS_COMP, SELLER_REMARKS, CLOSE_DESC, IS_EALUATE, 
    	FINISH_TIME, CANCEL_TIME, CREATE_NAME, UPDATE_NAME, DEL_NAME, DEL_TIME, order_type, 
    	CANCEL_TYPE from ord_order_info where 1=1
    	<if test="orderNum!=null and orderNum!=''">
			AND order_num like #{orderNum,jdbcType=VARCHAR} 
		</if>
		 <!-- 订单状态不为空时添加订单状态条件 -->
		<if test="orderState!=null and orderState!=''">
			AND order_State = #{orderState,jdbcType=DECIMAL} 
		</if>
		<if test="isDelete!=null and isDelete!=''">
			AND is_Delete = #{isDelete,jdbcType=DECIMAL} 
		</if>
		<if test="logisticsNum!=null and logisticsNum!=''">
			AND logistics_num like #{logisticsNum,jdbcType=VARCHAR} 
		</if>
		<if test="isEaluate!=null and isEaluate!=''">
			AND is_Ealuate = #{isEaluate,jdbcType=DECIMAL} 
		</if>
		<if test="orderType!=null and orderType!=''">
			AND order_type = #{orderType,jdbcType=DECIMAL} 
		</if>
		<if test="cancelType!=null and cancelType!=''">
			AND cancel_Type = #{cancelType,jdbcType=DECIMAL} 
		</if>
		 <!-- 排序字段 ,方式（ase desc） -->
		<if test="sorter!=null and sorter!=''">
			 ORDER BY #{sorter}
		</if>
  		  limit #{startPage, jdbcType=DECIMAL},#{endPage, jdbcType=DECIMAL}
  </select>
   <select id="getOrdInfoCount" parameterType="map" resultType="int">
   		select count(0) from ord_order_info where 1=1 and IS_DELETE=0
   	  	<!-- 买家 -->
  		<if test="userType=='1'.toString()">
			AND USER_ID = #{userId,jdbcType=VARCHAR} 
		</if>
  		 <!-- 卖家 -->
  		<if test="userType=='2'.toString()">
			AND SELLER_ID = #{userId,jdbcType=VARCHAR} 
		</if>
		<!--  订单状态不为空时添加订单状态条件 -->
		 <if test="orderState!=null and orderState!=''">
			AND order_State = #{orderState,jdbcType=VARCHAR} 
		</if>
  </select>
  <select id="getIsRefund" parameterType="map" resultType="int">
  	select count(0) from ord_refund_request where ORDER_ID=#{orderId,jdbcType=VARCHAR} and 
  	PRODUCT_ID = #{productId,jdbcType=VARCHAR} and PRODUCT_SPEC = #{productSpec,jdbcType=VARCHAR}
  </select>
</mapper>
  
  
  		
  