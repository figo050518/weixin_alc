$(document).ready(function() {
	//获取实时分页数据
	function getResponseData(obj,upState){
		var response=new Array();
		//查询被选中的,初次
		if(obj==0){
			pageIndex=1;//初次加载，从第一页开始
		}else{
			pageIndex=obj+1;
		}
		$.ajax({
			type:'post',
			url:'/uc/product/mylist',
			data:{"pageIndex":pageIndex,'upState':upState},
			async:false,
			success:function(obj){
				response = obj.products;
				if(upState==1){
					$("#onSaleCount").html(obj.totalCount);
					$("#offSaleCount").html(obj.totalCountAll*1-obj.totalCount*1);
				}
				if(upState==0){
					$("#offSaleCount").html(obj.totalCount);
					$("#onSaleCount").html(obj.totalCountAll*1-obj.totalCount*1);
				}
			}
		});
		return response;	
	}

	
	function loadData(obj,upState){     //初始化页面  上架商品查询
		var response=getResponseData(obj,upState);
		var html="";
		var blankHtml="";
		if(response==0 && obj=="0"){
		}else{
			
			for(var e in response){
				html+="<div class='oneGoods'><div class='checkGoods'><label class='checkboxDiv'><input type='checkbox' class='opaction goodsCheck'/></label></div><div class='goodsImgDiv'><img src='/resources/images/goodsImg.png' class='goodsImg'/>"+
				"</div><div class='goodsInfo'><div class='goodsName'>"+response[e].productName+"<div class='goodsInfoFloor'><div class='inventory'><span>库存：</span><span>"+response[e].stocks+"&nbsp;&nbsp;</span><span>";
				//平台上架
				if(response[e].fromType==2){
					html+="利润：¥</span><span>"+response[e].maxPrice;//不确定
				}		
				html+="<div><span>售价：</span><span class='price'>¥"+response[e].minPrice+"~"+response[e].maxPrice+"</span></div></div></div>";
				html+="<div class='clear'></div><div class='operationDiv' onclick='operationList(this)'><img src='/resources/images/operationImg.png' class='operationIcon'/></div>"+
				"<div class='operationList' style='display: none;'><div class='navigation'><table cellpadding='0' cellspacing='0' class='operationTab'><tr><td>"+
				"<div class='floorNav'><img src='/resources/images/edit.png' class='operationImg'/></div><div class='operationName' onclick='edit("+response[e].id+")'>编辑</div></td><td><div class='floorNav'><img src='/resources/images/xiajia.png' class='operationImg'/>"+
				"</div><div class='operationName' onclick='offline("+response[e].id+")'>下架</div></td><td><div class='floorNav'><img src='/resources/images/fenlei.png' class='operationImg'/></div><div class='operationName' onclick='setFenLei()'>分类</div></td><td>"+
				"<div class='floorNav'><img src='/resources/images/edit.png' class='operationImg'/></div><div class='operationName'>删除</div></td><td><div class='floorNav'><img src='/resources/images/tuiguang.png' class='operationImg'/></div>"+
				"<div class='operationName'>推广</div></td><td><div class='floorNav'><img src='/resources/images/zhiding.png' class='operationImg'/></div><div class='operationName'>置顶</div></td></tr></table>"+
				"+</div><div class='sanjiao'></div></div></div></div>";
				}		
			$("#goodsList").html(html);
		}
	}
	loadData(0,1);
	
	
    })
    
    	
	function edit(id){
		window.location.href="/uc/product/preEdit?id="+id;
	}

	function offline(productId){
		$.ajax({
			type:'post',
			url:'/uc/product/upStateUpdate',
			data:{"productId":productId,'state':0},
			async:false,
			success:function(res){
				
				if(res=="success"){
					Info.view("下架成功！");
					window.location.href="/uc/product/initList";
				}
				if(upState==0){
					Info.view("下架失败！");
				}
			}
		});
		
	}
	
	//点击设置分类
	function setFenLei(){
		alert(11)
	}