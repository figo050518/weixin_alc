<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%> 
<%@ taglib prefix='fmt' uri="http://java.sun.com/jsp/jstl/fmt" %>
<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>我的售后</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="/resources/style/afterSales.css">
		<link rel="stylesheet" href="/resources/style/info.css">
	</head>
	<body>
		<input value="${refundStatus}" class="refundStatus" type="hidden">
		<div class="head">
			<div class="title">
				<span>我的售后</span>
			</div> 
			<div class="return" onclick="history.go(-1)">
				<span class="returnImg"></span><span>返回</span>
			</div>
		</div>
		<table class="tapDiv">
			<tr>
				<td style="border-bottom:2px solid #D13600;">
					<div class="tap" mag="-1" id="tap1" onclick="findOrderRefundType('-1')">全部</div>
				</td>
				<td style="border-bottom: 1px solid #EBECEE;">
					<div class="tap" mag="0" id="tap2" onclick="findOrderRefundType('0')">待退货</div>
				</td>
				<td style="border-bottom: 1px solid #EBECEE;">
					<div class="tap" mag="1" id="tap3" onclick="findOrderRefundType('1')">待维修</div>
				</td>
				<td style="border-bottom: 1px solid #EBECEE;">
					<div class="tap" mag="2" id="tap4" onclick="findOrderRefundType('2')">已完成</div>
				</td>
			</tr>
		</table>
		<c:if test="${not empty page.rows}">
<div id="pullrefresh" class="mui-content mui-scroll-wrapper" style="background:#fff;margin-top:calc(50px + 10vw);">
	<div class="mui-scroll">
		<!--数据列表-->
		<ul class="mui-table-view mui-table-view-chevron" style="background: #EFEFF4;border:0px;" id="goodsListInfo">
		<c:forEach items="${page.rows}" var="orderRefundRequestDTOs">
		<li style="padding: 0px;background:#fff;width:100%;position: relative;" class="mui-table-view-cell">
			<div class="oneOrder" id="${orderRefundRequestDTOs.orderRefundRequestPO.id}">
				<div class="orderInfoDiv">
					<div class="orderNum">
						<span>售后单号：${orderRefundRequestDTOs.orderRefundRequestPO.refundNumber}</span>
					</div>
					<div class="orderTime">
						<span><fmt:formatDate value="${orderRefundRequestDTOs.orderRefundRequestPO.createTime}" pattern="yyyy-MM-dd HH:mm:ss" /></span>
					</div>
					<div class="clear"></div>
				</div>
				<div class="oneGoods">
					<div class="goodsImgDiv">
						<img src="/resources/images/${orderRefundRequestDTOs.orderRefundRequestPO.productPicUrl}" class="goodsImg"/>
					</div>
					<div class="goodsInfo">
						<div class="goodsName">${orderRefundRequestDTOs.orderRefundRequestPO.productName}</div>
						<div class="goodsInfoFloor">
							<div class="inventory">
								<span>单价：${orderRefundRequestDTOs.orderRefundRequestPO.productPrice}</span>
								<c:if test="${orderRefundRequestDTOs.orderRefundRequestPO.isTuihuo=='1'}">
									<span>退货数量：${orderRefundRequestDTOs.orderRefundRequestPO.productQuant}</span>
								</c:if>
								<span>规格：¥${orderRefundRequestDTOs.orderRefundRequestPO.productSpec}</span>
							</div>
							<div>
								<span>总价：</span><span class="price">¥${orderRefundRequestDTOs.orderRefundRequestPO.productTotalAmount}</span>
							</div>
						</div>
					</div>
					<div class="clear"></div>
				</div>
				<div class="goodsOperation">
				<!-- 售后状态 1 申请中2已通过3已完成 4：拒绝 -->
					<c:choose>
						<c:when test="${orderRefundRequestDTOs.orderRefundRequestPO.refundStatus=='1'}">
							<div class="goodsStatus">申请中</div>
							<!-- 不同身份显示按钮 -->
							<!-- 卖家 -->	
							<c:if test="${userType=='2'}">
							<!-- 判断是否是自营商品 -->
							  <!-- 1=自营，2=平台上架 商品来源  是否已经交给非常购审核的标识,1:已经，0:没有-->
								<c:if test="${orderRefundRequestDTOs.productType=='2' && orderRefundRequestDTOs.orderRefundRequestPO.fcgRefundFlag=='0'}">
									<button class="goodsBtn">移交非常购</button>
								</c:if>
								<c:if test="${orderRefundRequestDTOs.productType=='1'}">
									<button class="goodsBtn">通过</button>
									<button class="goodsBtn">拒绝</button>
								</c:if>
							</c:if>
						</c:when>
						<c:when test="${orderRefundRequestDTOs.orderRefundRequestPO.refundStatus=='2'}">
							<div class="goodsStatus">已通过</div>
						</c:when>
						<c:when test="${orderRefundRequestDTOs.orderRefundRequestPO.refundStatus=='3'}">
							<div class="goodsStatus">已完成</div>
						</c:when>
						<c:when test="${orderRefundRequestDTOs.orderRefundRequestPO.refundStatus=='4'}">
							<div class="goodsStatus">已拒绝</div>
						</c:when>
					</c:choose>
					
					<div class="clear"></div>
				</div>
			</div>
			</li>
			</c:forEach>
			</ul>
		</div>
	</div>
	</c:if>
	<!--订单为空时-->
	<c:if test="${empty page.rows}">
		<div class="blankState">
			<div class="blankImgDiv">
				<img src="/resources/images/orderBlank.png" class="blankImg"/>
			</div>
			<div class="blankText">您还没有相关订单哦！</div>
			<div class="blankBtnDiv">
				<button class="blankBtn">这是按钮</button>
			</div>
		</div>
	</c:if>
	</body>
	<script src="/resources/script/jquery-1.11.1.min.js"></script>
	<script src="/resources/script/info.js"></script>
	<script src="/resources/script/order/aterSales.js"></script>
</html>