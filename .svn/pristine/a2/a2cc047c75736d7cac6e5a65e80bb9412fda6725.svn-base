$(".checkall").click(function() {
	if($(this).is(":checked")) {
		$(".checkone").prop('checked', true);
		$(".checkoneall").prop('checked', true);
	} else {
		$('.checkone').attr('checked', false);
		$('.checkoneall').attr('checked', false);

	}
});
$(".checkone").click(function() {
	var goodsN = $(".shangjia").find(".checkone");

	var goodsC = $(".shangjia").find(".checkone:checked");
	if(goodsN.length == goodsC.length) {
		$(".checkall").prop('checked', true);
	} else {
		$(".checkall").prop('checked', false);
	}
})



$(function(){
	loadData(0);
});
(function($, doc) {
	$.init();
	$.ready(function() {
		
	});
})(mui, document);




//-----------------------------------------------------------------
mui.init({
	pullRefresh: {
		container: '#pullrefresh',
		down: {
			callback: pulldownRefresh
		},
		up: {
			contentrefresh: '正在加载...',
			callback: pullupRefresh
		}
	}
});

/**
 * 下拉刷新具体业务实现
 */
function pulldownRefresh() {
	setTimeout(function() {
		loadData(0);//初次加载
		//document.getElementById('businessSummary').innerHTML=html;
		mui('#pullrefresh').pullRefresh().endPulldownToRefresh(); //refresh completed
		//mui('#pullrefresh').pullRefresh().refresh(true);
	}, 500);
}

/**
 * 上拉加载具体业务实现
 */
var pageIndex=0;
function pullupRefresh() {
	setTimeout(function() {
		mui('#pullrefresh').pullRefresh().endPullupToRefresh(); //参数为true代表没有更多数据了。
		var table = document.body.querySelector('.mui-table-view');
		var response = getResponseData(pageIndex);
		for(var e in response){
			li = document.createElement('li');
			li.setAttribute("style","padding: 0px;background: #FFFFFF;width:100vw;position: relative;margin-bottom:5px;");
			li.setAttribute("id",response[e].id);
			li.className = 'mui-table-view-cell';
			var htm="";
			htm+="<div class='shangjiaPdtItem'>"+
					"<div class='itemLeft'>"+
						"<label><input type='checkbox'  name='' id='' class='check checkone' value='' /></label>"+
					"</div>"+
					"<div class=''itemimg><img src='/resources/images/0052_foodsense.jpg'/></div>"+
					/*"<div class=''itemimg><img src='/images/products/orgin/"+response[e].productPicId+"'/></div>"+*/
					"<div class='pdtInfo'>"+
						"<span class='pdtName'>"+response[e].productName+"</span>"+
						"<span class='pdtPrice'>￥<span style='display: inline;'>99.00</span></span>"+
						/*"<span class='pdtPrice'>￥<span style='display: inline;'>"+response[e].price+"</span></span>"*/
					"</div></div>";
			li.innerHTML = htm;
			table.appendChild(li);
		}
	}, 500);
}

function loadData(obj){     //初始化页面
	var response=getResponseData(obj);
	var html="";
	for(var e in response){
		html+="<li class='mui-table-view-cell' style='padding: 0px;background: #FFFFFF;width:100vw;position: relative;margin-bottom:5px;' id='"+response[e].id+"'>"+
				"<div class='shangjiaPdtItem'>"+
					"<div class='itemLeft'>"+
						"<label><input type='checkbox'  name='' id='' class='check checkone' value='' /></label>"+
					"</div>"+
					"<div class=''itemimg><img src='/resources/images/0052_foodsense.jpg'/></div>"+
					"<div class='pdtInfo'>"+
					"<span class='pdtName'>"+response[e].productName+"</span>"+
						"<span class='pdtPrice'>￥<span style='display: inline;'>99.00</span></span>"+
					"</div></div>";
			"</li>";
	}
	$("#goodsList").html(html);
}

//获取实时分页数据
function getResponseData(obj){
	var response=new Array();
	//查询被选中的,初次
	if(obj==0){
		pageIndex=1;//初次加载，从第一页开始
	}else{
		pageIndex=obj+1;
	}
	$.ajax({
		type:'post',
		url:'/product/fav/list',
		data:{"pageIndex":pageIndex},
		async:false,
		success:function(obj){
			response = obj.userProductFavPOs;
		}
	});
	return response;	
}