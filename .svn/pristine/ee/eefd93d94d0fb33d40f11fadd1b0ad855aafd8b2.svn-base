<!DOCTYPE html>
<%@ page contentType="text/html;charset=UTF-8" %>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>

<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title>创建店铺管理</title>
		<link rel="stylesheet" type="text/css" href="${pageContext.request.contextPath}/resources/style/dianpuguanli.css" />
		<link rel="stylesheet" type="text/css" href="${pageContext.request.contextPath}/resources/style/info.css" />
		<link rel="stylesheet" type="text/css" href="${pageContext.request.contextPath}/resources/style/jquery.validate.css" />
		<script src="${pageContext.request.contextPath}/resources/script/jquery-1.11.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="${pageContext.request.contextPath}/resources/script/jquery.validate.js" type="text/javascript" charset="utf-8"></script>
		<script src="${pageContext.request.contextPath}/resources/script/jquery.validate.method.js" type="text/javascript" charset="utf-8"></script>
		
		 <script type="text/javascript">
    $(document).ready(function() {
    	var maxsize = 500*1024;//500K 
        var errMsg = "上传的附件文件不能超过500K！！！";  
        var tipMsg = "您的浏览器暂不支持计算上传文件的大小，确保上传文件不要超过500K，建议使用IE、FireFox、Chrome浏览器。";  
        var  browserCfg = {};  
        var ua = window.navigator.userAgent;  
        if (ua.indexOf("MSIE")>=1){  
            browserCfg.ie = true;  
        }else if(ua.indexOf("Firefox")>=1){  
            browserCfg.firefox = true;  
        }else if(ua.indexOf("Chrome")>=1){  
            browserCfg.chrome = true;  
        }  
    	function checkfile(){  
            try{  
                var obj_file = document.getElementById("file");  
                if(obj_file.value==""){  
                    alert("请先选择店铺头像");  
                    return;  
                }  
                var filesize = 0;  
                if(browserCfg.firefox || browserCfg.chrome ){  
                    filesize = obj_file.files[0].size;  
                }else if(browserCfg.ie){  
                    var obj_img = document.getElementById('tempimg');  
                    obj_img.dynsrc=obj_file.value;  
                    filesize = obj_img.fileSize;  
                }else{  
                	fileFlage =false;
                    alert(tipMsg);  
                return;  
                }  
                if(filesize==-1){  
                    alert(tipMsg);  
                    fileFlag =false;
                    return;  
                }else if(filesize>maxsize){  
                    alert(errMsg);  
                    fileFlag =false;
                    return;  
                }else{  
                    fileFlag =true;
                    return;  
                }  
            }catch(e){  
                alert(e);  
            }  
        } 
    	$("#inputForm").validate({
            submitHandler: function(form){
            	checkfile();
            	if(!fileFlag){
            		return;
            	}
            	  var shopName = document.getElementById("shopName");  
                  if(shopName==""|| shopName.length>0){  
                      alert("店铺名称不能为空");  
                      return;  
                  }  
                  var shopDesc = document.getElementById("shopDesc");  
                  if(shopDesc==""|| shopDesc.length>0){  
                      alert("店铺简介不能为空");  
                      return;  
                  }  
              if (confirm("确认创建?")) {
              	//loading('正在提交，请稍等...');
              	form.submit();
              }
            },
            errorContainer: "#messageBox",
            errorPlacement: function(error, element) {
          /*     $("#messageBox").text("输入有误，请先更正。");
              if (element.is(":checkbox")||element.is(":radio")||element.parent().is(".input-append")){
                error.appendTo(element.parent().parent());
              } else {
                error.insertAfter(element);
              } */
            }
          });
	
    })
  </script>
	</head>

	<body>
		<table width="100%" class="titleTable"  border="0" cellspacing="0" cellpadding="0">
			<tr>
				<td style="width: 20%;text-align: left;"><img src="${pageContext.request.contextPath}/resources/images/prev1.png" style="margin-right:5px;"/>返回</td>
				<title>店铺管理</title>
				<td style="width: 20%;text-align: left;"></td>
			</tr>
		</table>
		<form:form id="inputForm" modelAttribute="SellerShop" action="${pageContext.request.contextPath}/shop/save" method="post" class="form-horizontal" enctype="multipart/form-data">
		 <form:input path="fcgUserId" id="fcgUserId" class="" value="${fcgUserId}" type="hidden" />	
			<div class="content">
			<div class="contentItem">
				<div id="">店铺名称</div>
				<form:input type="text" path="shopName" id="shopName" class="shopName" value="" placeholder="请填写店铺名称" />	
			</div>
			<div class="contentItemIntro">
				<div id="">店铺简介</div>
				<form:textarea type="text" path="shopDesc" class="jianjieText" id="shopDesc" placeholder="请填写店铺简介" /></textarea>
			</div>
			<div class="contentItemImg">
				<img id="tempimg" dynsrc="" src="" style="display:none" />
				<input type="file" name="file" id="file" value="" />
				<div id="">店铺头像</div>
				<div class="imgdiv"><img src="${pageContext.request.contextPath}/resources/images/icon_kuang2.png"/></div>
			</div>
		</div>
		<button class="createShop" type="submit" id="creatBtn" value="立即创建">立即创建</button>
		</form:form>
		<script src="${pageContext.request.contextPath}/resources/script/dianpuguanli.js" type="text/javascript" charset="utf-8"></script>
		<script src="${pageContext.request.contextPath}/resources/script/info.js" type="text/javascript" charset="utf-8"></script>
	</body>

</html>